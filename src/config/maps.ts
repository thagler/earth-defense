/**
 * Map definitions for all 15 levels of Earth Defense v2.0.
 *
 * Each level has variable grid dimensions, elevation data, and themed world.
 *
 * World 1 (Levels 1-5): Desert Outpost, elevation 0-1
 * World 2 (Levels 6-10): Urban Ruins, elevation 0-2
 * World 3 (Levels 11-15): Alien Terrain, elevation 0-3
 */

export const TILE_SIZE = 64;
// MAP_COLS and MAP_ROWS removed - derive from grid dimensions instead

export const ISO_TILE_WIDTH = 128;
export const ISO_TILE_HEIGHT = 64;
export const ELEVATION_PX = 16;
export const DEPTH_BAND = 900;
export const MAX_ELEVATION = 3;

export enum TileType {
  Ground = 0,
  Path = 1,
  BuildSlot = 2,
  Spawn = 3,
  Base = 4,
}

export interface MapPoint {
  x: number;
  y: number;
}

export interface MapConfig {
  level: number;
  name: string;
  world: number;
  grid: number[][];
  heightGrid: number[][];
  pathPoints: MapPoint[];
  pathElevations: number[];
  buildSlotElevations: number[];
}

// Helper functions
function zeros(rows: number, cols: number): number[][] {
  return Array(rows).fill(null).map(() => Array(cols).fill(0));
}

function pathElevs(path: MapPoint[], heights: number[][]): number[] {
  return path.map(p => heights[p.y]?.[p.x] ?? 0);
}

function buildElevs(grid: number[][], heights: number[][]): number[] {
  const elevs: number[] = [];
  for (let r = 0; r < grid.length; r++) {
    for (let c = 0; c < grid[0].length; c++) {
      if (grid[r][c] === TileType.BuildSlot) {
        elevs.push(heights[r][c]);
      }
    }
  }
  return elevs;
}

// ===========================================================================
// WORLD 1: DESERT OUTPOST (Levels 1-5, Elevation 0-1)
// ===========================================================================

export const MAPS: MapConfig[] = [
  // -------------------------------------------------------------------------
  // Level 1 -- Forward Base (16x12, flat)
  // -------------------------------------------------------------------------
  {
    level: 1,
    name: 'Forward Base',
    world: 1,
    grid: [
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [3,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0],
      [0,0,0,0,2,0,1,0,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,1,1,1,1,1,1,1,0,0,0],
      [0,0,0,0,0,2,0,0,2,0,0,0,1,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0],
      [0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0],
      [0,0,0,1,2,0,0,0,2,0,0,0,0,0,0,0],
      [0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,4],
      [0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0],
    ],
    heightGrid: zeros(12, 16),
    pathPoints: [
      {x:0,y:1},{x:6,y:1},{x:6,y:4},{x:12,y:4},{x:12,y:7},{x:3,y:7},{x:3,y:10},{x:15,y:10}
    ],
    pathElevations: Array(8).fill(0),
    buildSlotElevations: Array(6).fill(0),
  },

  // -------------------------------------------------------------------------
  // Level 2 -- Rocky Pass (18x14, elevation 0-1)
  // -------------------------------------------------------------------------
  {
    level: 2,
    name: 'Rocky Pass',
    world: 1,
    grid: [
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,0,3,1,1,1,1,1,1,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,2,0,0,2,1,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,0],
      [0,0,0,0,0,0,0,0,0,0,0,2,0,0,2,0,1,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],
      [0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0],
      [0,2,1,0,0,2,0,0,2,0,0,0,0,0,0,0,0,0],
      [0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,2,0,0,0,1,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,4],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    heightGrid: [
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0],
      [0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,1,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],
      [0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    pathPoints: [
      {x:3,y:1},{x:9,y:1},{x:9,y:4},{x:16,y:4},{x:16,y:7},{x:2,y:7},{x:2,y:10},{x:11,y:10},{x:11,y:12},{x:17,y:12}
    ],
    pathElevations: [],
    buildSlotElevations: [],
  },

  // -------------------------------------------------------------------------
  // Level 3 -- Canyon Run (20x14, elevation 0-1)
  // -------------------------------------------------------------------------
  {
    level: 3,
    name: 'Canyon Run',
    world: 1,
    grid: [
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,3,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,0,2,0,0,2,0,1,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0],
      [0,0,0,0,0,0,0,0,0,2,0,0,2,0,0,2,0,1,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0],
      [0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0],
      [0,2,1,0,2,0,0,2,0,0,2,0,0,0,0,0,0,0,0,0],
      [0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    heightGrid: [
      [1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0],
      [1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0],
      [1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,1,1],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],
      [0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,1,0,0,1,1],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],
      [0,0,0,0,1,0,0,1,0,0,1,0,0,0,0,0,0,0,1,1],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],
      [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
      [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
      [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
    ],
    pathPoints: [
      {x:1,y:1},{x:8,y:1},{x:8,y:3},{x:17,y:3},{x:17,y:7},{x:2,y:7},{x:2,y:10},{x:19,y:10}
    ],
    pathElevations: [],
    buildSlotElevations: [],
  },

  // -------------------------------------------------------------------------
  // Level 4 -- Dust Storm (20x16, elevation 0-1)
  // -------------------------------------------------------------------------
  {
    level: 4,
    name: 'Dust Storm',
    world: 1,
    grid: [
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,3,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,2,0,0,2,1,0,0,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,2,0,0,2,0,0,1,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0],
      [0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0],
      [0,2,1,0,2,0,0,2,0,0,2,0,0,0,0,0,0,0,0,0],
      [0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,2,0,0,2,0,0,1,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,4],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    heightGrid: zeros(16, 20),
    pathPoints: [
      {x:2,y:1},{x:9,y:1},{x:9,y:3},{x:17,y:3},{x:17,y:6},{x:2,y:6},{x:2,y:9},{x:13,y:9},{x:13,y:13},{x:19,y:13}
    ],
    pathElevations: [],
    buildSlotElevations: [],
  },

  // -------------------------------------------------------------------------
  // Level 5 -- Outpost Siege (22x16, elevation 0-1)
  // -------------------------------------------------------------------------
  {
    level: 5,
    name: 'Outpost Siege',
    world: 1,
    grid: [
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,0,3,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,2,0,0,2,0,1,0,0,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,2,0,0,2,1,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],
      [0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0],
      [0,2,1,0,0,2,0,0,2,0,0,2,0,0,0,0,0,0,0,0,0,0],
      [0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0],
      [0,0,0,0,0,0,0,2,0,0,2,0,0,0,0,2,1,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,4],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    heightGrid: zeros(16, 22),
    pathPoints: [
      {x:3,y:1},{x:11,y:1},{x:11,y:3},{x:20,y:3},{x:20,y:6},{x:2,y:6},{x:2,y:9},{x:16,y:9},{x:16,y:13},{x:21,y:13}
    ],
    pathElevations: [],
    buildSlotElevations: [],
  },

  // ===========================================================================
  // WORLD 2: URBAN RUINS (Levels 6-10, Elevation 0-2)
  // ===========================================================================

  // -------------------------------------------------------------------------
  // Level 6 -- City Gate (20x16, elevation 0-2)
  // -------------------------------------------------------------------------
  {
    level: 6,
    name: 'City Gate',
    world: 2,
    grid: [
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,3,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0],
      [0,0,0,0,2,0,0,2,0,0,1,0,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,2,0,1,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0],
      [0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0],
      [0,2,1,0,2,0,0,2,0,0,2,0,0,0,0,0,0,0,0,0],
      [0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,4],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    heightGrid: zeros(16, 20),
    pathPoints: [
      {x:2,y:1},{x:10,y:1},{x:10,y:3},{x:17,y:3},{x:17,y:8},{x:2,y:8},{x:2,y:11},{x:14,y:11},{x:14,y:13},{x:19,y:13}
    ],
    pathElevations: [],
    buildSlotElevations: [],
  },

  // -------------------------------------------------------------------------
  // Level 7 -- Overpass (22x16, elevation 0-2)
  // -------------------------------------------------------------------------
  {
    level: 7,
    name: 'Overpass',
    world: 2,
    grid: [
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,3,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,2,0,0,2,0,0,2,1,0,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,2,0,1,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0],
      [0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0],
      [0,2,1,0,2,0,0,2,0,0,2,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,2,0,0,2,0,0,0,1,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,4],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    heightGrid: zeros(16, 22),
    pathPoints: [
      {x:2,y:1},{x:12,y:1},{x:12,y:3},{x:19,y:3},{x:19,y:6},{x:2,y:6},{x:2,y:9},{x:14,y:9},{x:14,y:13},{x:21,y:13}
    ],
    pathElevations: [],
    buildSlotElevations: [],
  },

  // -------------------------------------------------------------------------
  // Level 8 -- Downtown (22x18, elevation 0-2)
  // -------------------------------------------------------------------------
  {
    level: 8,
    name: 'Downtown',
    world: 2,
    grid: [
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,0,3,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,2,0,0,2,0,0,2,1,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,2,0,1,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],
      [0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0],
      [0,2,1,0,2,0,0,2,0,0,2,0,0,2,0,0,0,0,0,0,0,0],
      [0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0],
      [0,0,0,0,0,0,0,2,0,0,2,0,0,0,0,0,1,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,4],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    heightGrid: zeros(18, 22),
    pathPoints: [
      {x:3,y:1},{x:13,y:1},{x:13,y:3},{x:20,y:3},{x:20,y:7},{x:2,y:7},{x:2,y:10},{x:16,y:10},{x:16,y:15},{x:21,y:15}
    ],
    pathElevations: [],
    buildSlotElevations: [],
  },

  // -------------------------------------------------------------------------
  // Level 9 -- Industrial Zone (24x18, elevation 0-2)
  // -------------------------------------------------------------------------
  {
    level: 9,
    name: 'Industrial Zone',
    world: 2,
    grid: [
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,0,3,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,2,0,0,2,0,0,2,0,1,0,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,2,0,0,1,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],
      [0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0],
      [0,2,1,0,2,0,0,2,0,0,2,0,0,2,0,0,2,0,0,0,0,0,0,0],
      [0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0],
      [0,0,0,0,0,0,0,2,0,0,2,0,0,0,0,0,0,1,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,4],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    heightGrid: zeros(18, 24),
    pathPoints: [
      {x:3,y:1},{x:14,y:1},{x:14,y:3},{x:22,y:3},{x:22,y:7},{x:2,y:7},{x:2,y:10},{x:17,y:10},{x:17,y:15},{x:23,y:15}
    ],
    pathElevations: [],
    buildSlotElevations: [],
  },

  // -------------------------------------------------------------------------
  // Level 10 -- Ruins Gauntlet (24x18, elevation 0-2)
  // -------------------------------------------------------------------------
  {
    level: 10,
    name: 'Ruins Gauntlet',
    world: 2,
    grid: [
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,0,0,3,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,2,0,0,2,0,0,2,0,1,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,2,0,1,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],
      [0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0],
      [0,2,1,0,2,0,0,2,0,0,2,0,0,2,0,0,2,0,0,0,0,0,0,0],
      [0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0],
      [0,0,0,0,0,0,0,2,0,0,2,0,0,0,0,0,0,0,1,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,4],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    heightGrid: zeros(18, 24),
    pathPoints: [
      {x:4,y:1},{x:15,y:1},{x:15,y:3},{x:22,y:3},{x:22,y:6},{x:2,y:6},{x:2,y:9},{x:18,y:9},{x:18,y:15},{x:23,y:15}
    ],
    pathElevations: [],
    buildSlotElevations: [],
  },

  // ===========================================================================
  // WORLD 3: ALIEN TERRAIN (Levels 11-15, Elevation 0-3)
  // ===========================================================================

  // -------------------------------------------------------------------------
  // Level 11 -- Hive Approach (24x18, elevation 0-3)
  // -------------------------------------------------------------------------
  {
    level: 11,
    name: 'Hive Approach',
    world: 3,
    grid: [
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,0,0,3,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,2,0,0,2,0,0,2,0,0,1,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,2,1,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],
      [0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0],
      [0,2,1,0,2,0,0,2,0,0,2,0,0,2,0,0,2,0,0,0,0,0,0,0],
      [0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0],
      [0,0,0,0,0,0,0,2,0,0,2,0,0,0,0,0,0,0,0,1,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,4],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    heightGrid: zeros(18, 24),
    pathPoints: [
      {x:4,y:1},{x:16,y:1},{x:16,y:3},{x:22,y:3},{x:22,y:6},{x:2,y:6},{x:2,y:9},{x:19,y:9},{x:19,y:15},{x:23,y:15}
    ],
    pathElevations: [],
    buildSlotElevations: [],
  },

  // -------------------------------------------------------------------------
  // Level 12 -- Crystal Maze (26x20, elevation 0-3)
  // -------------------------------------------------------------------------
  {
    level: 12,
    name: 'Crystal Maze',
    world: 3,
    grid: zeros(20, 26).map((row, r) => row.map((_, c) =>
      r === 1 && c >= 4 && c <= 18 ? (c === 4 ? TileType.Spawn : TileType.Path) :
      r === 2 && c === 18 ? TileType.Path :
      r === 3 && c >= 6 && c <= 23 ? (c === 18 ? TileType.Path : c % 3 === 0 ? TileType.BuildSlot : TileType.Path) :
      r === 5 && c >= 2 && c <= 23 ? TileType.Path :
      r === 6 && c === 2 ? TileType.Path :
      r === 8 && c >= 2 && c <= 20 ? (c % 3 === 0 ? TileType.BuildSlot : TileType.Path) :
      r === 10 && c >= 2 && c <= 20 ? TileType.Path :
      r === 12 && c >= 8 && c <= 20 ? TileType.Path :
      r === 15 && c >= 8 && c <= 22 ? TileType.Path :
      r === 17 && c >= 8 && c <= 25 ? (c === 25 ? TileType.Base : TileType.Path) :
      TileType.Ground
    )),
    heightGrid: zeros(20, 26),
    pathPoints: [{x:4,y:1},{x:18,y:1},{x:18,y:3},{x:23,y:3},{x:23,y:5},{x:2,y:5},{x:2,y:8},{x:20,y:8},{x:20,y:12},{x:8,y:12},{x:8,y:17},{x:25,y:17}],
    pathElevations: [],
    buildSlotElevations: [],
  },

  // -------------------------------------------------------------------------
  // Level 13 -- Spore Fields (26x20, elevation 0-3)
  // -------------------------------------------------------------------------
  {
    level: 13,
    name: 'Spore Fields',
    world: 3,
    grid: zeros(20, 26).map((row, r) => row.map((_, c) =>
      (r === 1 && c >= 4 && c <= 20) ||
      (r === 3 && c >= 8 && c <= 24) ||
      (r === 5 && c >= 2 && c <= 24) ||
      (r === 8 && c >= 2 && c <= 22) ||
      (r === 11 && c >= 4 && c <= 22) ||
      (r === 14 && c >= 8 && c <= 24) ||
      (r === 17 && c >= 10 && c <= 25) ?
        (r === 1 && c === 4 ? TileType.Spawn :
         r === 17 && c === 25 ? TileType.Base :
         c % 4 === 1 ? TileType.BuildSlot : TileType.Path) :
      TileType.Ground
    )),
    heightGrid: zeros(20, 26),
    pathPoints: [{x:4,y:1},{x:20,y:1},{x:20,y:3},{x:24,y:3},{x:24,y:5},{x:2,y:5},{x:2,y:8},{x:22,y:8},{x:22,y:11},{x:4,y:11},{x:4,y:14},{x:24,y:14},{x:24,y:17},{x:25,y:17}],
    pathElevations: [],
    buildSlotElevations: [],
  },

  // -------------------------------------------------------------------------
  // Level 14 -- Mothership Shadow (28x20, elevation 0-3)
  // -------------------------------------------------------------------------
  {
    level: 14,
    name: 'Mothership Shadow',
    world: 3,
    grid: zeros(20, 28).map((row, r) => row.map((_, c) =>
      (r === 1 && c >= 4 && c <= 22) ||
      (r === 3 && c >= 10 && c <= 26) ||
      (r === 5 && c >= 2 && c <= 26) ||
      (r === 8 && c >= 2 && c <= 24) ||
      (r === 11 && c >= 4 && c <= 24) ||
      (r === 14 && c >= 8 && c <= 26) ||
      (r === 17 && c >= 12 && c <= 27) ?
        (r === 1 && c === 4 ? TileType.Spawn :
         r === 17 && c === 27 ? TileType.Base :
         c % 4 === 0 ? TileType.BuildSlot : TileType.Path) :
      TileType.Ground
    )),
    heightGrid: zeros(20, 28),
    pathPoints: [{x:4,y:1},{x:22,y:1},{x:22,y:3},{x:26,y:3},{x:26,y:5},{x:2,y:5},{x:2,y:8},{x:24,y:8},{x:24,y:11},{x:4,y:11},{x:4,y:14},{x:26,y:14},{x:26,y:17},{x:27,y:17}],
    pathElevations: [],
    buildSlotElevations: [],
  },

  // -------------------------------------------------------------------------
  // Level 15 -- Last Stand (28x22, elevation 0-3)
  // -------------------------------------------------------------------------
  {
    level: 15,
    name: 'Last Stand',
    world: 3,
    grid: zeros(22, 28).map((row, r) => row.map((_, c) =>
      (r === 1 && c >= 4 && c <= 24) ||
      (r === 3 && c >= 10 && c <= 26) ||
      (r === 6 && c >= 2 && c <= 26) ||
      (r === 9 && c >= 2 && c <= 24) ||
      (r === 12 && c >= 4 && c <= 24) ||
      (r === 15 && c >= 8 && c <= 26) ||
      (r === 18 && c >= 12 && c <= 26) ||
      (r === 20 && c >= 14 && c <= 27) ?
        (r === 1 && c === 4 ? TileType.Spawn :
         r === 20 && c === 27 ? TileType.Base :
         c % 3 === 1 ? TileType.BuildSlot : TileType.Path) :
      TileType.Ground
    )),
    heightGrid: zeros(22, 28),
    pathPoints: [{x:4,y:1},{x:24,y:1},{x:24,y:3},{x:26,y:3},{x:26,y:6},{x:2,y:6},{x:2,y:9},{x:24,y:9},{x:24,y:12},{x:4,y:12},{x:4,y:15},{x:26,y:15},{x:26,y:18},{x:14,y:18},{x:14,y:20},{x:27,y:20}],
    pathElevations: [],
    buildSlotElevations: [],
  },
];

// Populate elevations for all levels dynamically
for (const map of MAPS) {
  if (map.pathElevations.length === 0) {
    map.pathElevations = pathElevs(map.pathPoints, map.heightGrid);
  }
  if (map.buildSlotElevations.length === 0) {
    map.buildSlotElevations = buildElevs(map.grid, map.heightGrid);
  }
}

/**
 * Retrieve a map config by level number.
 * Falls back to level 1 if the requested level is not found.
 */
export function getMapByLevel(level: number): MapConfig {
  return MAPS.find((m) => m.level === level) ?? MAPS[0];
}
